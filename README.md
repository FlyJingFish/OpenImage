# OpenImage å›¾ç‰‡æŸ¥çœ‹å¤§å›¾åº“

[![Maven central](https://img.shields.io/maven-central/v/io.github.FlyJingFish.OpenImage/OpenImageLib)](https://central.sonatype.com/search?q=io.github.FlyJingFish.OpenImage)
[![GitHub stars](https://img.shields.io/github/stars/FlyJingFish/OpenImage.svg)](https://github.com/FlyJingFish/OpenImage/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/FlyJingFish/OpenImage.svg)](https://github.com/FlyJingFish/OpenImage/network/members)
[![GitHub issues](https://img.shields.io/github/issues/FlyJingFish/OpenImage.svg)](https://github.com/FlyJingFish/OpenImage/issues)
[![GitHub license](https://img.shields.io/github/license/FlyJingFish/OpenImage.svg)](https://github.com/FlyJingFish/OpenImage/blob/master/LICENSE)

## å±äºä½ çš„ä¾µå…¥æ€§ä½çš„å¤§å›¾æŸ¥çœ‹å™¨ï¼Œé«˜ä»¿å¾®ä¿¡å®Œç¾çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œæ”¯æŒè‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰åŠ è½½å›¾ç‰‡çš„å†…æ ¸ï¼Œä¾‹å¦‚Glideï¼ŒPicassoæˆ–å…¶ä»–çš„<br><br>å¦‚æœå¸®åˆ°ä½ ç‚¹ä¸ªstaræ¨å¹¿ç»™æ›´å¤šäººå§ï½

## [ç‚¹æ­¤ä¸‹è½½apk,ä¹Ÿå¯æ‰«ä¸‹è¾¹äºŒç»´ç ä¸‹è½½](https://github.com/FlyJingFish/OpenImage/blob/master/apk/release/app-release.apk?raw=true)

<img src="/screenshot/download_qrcode.png" alt="show" width="200px" />

## å¤šç§åœºæ™¯æ•ˆæœæ¼”ç¤ºï¼ˆä¸é™äºä»¥ä¸‹å‡ ç§ï¼Œæ›´å¤šæ”¯æŒ[ç‚¹æ­¤æŸ¥çœ‹](https://github.com/FlyJingFish/OpenImage/wiki)ï¼‰
 
RecyclerViewåœºæ™¯  | èŠå¤©é¡µé¢ | æ‰“å¼€è§†é¢‘
 ------ | ------ | ------   
 <img src="/screenshot/Screenrecording_20230519_124228.gif" alt="show" width="240px" />  | <img src="/screenshot/SVID_20220731_203549_1.gif" alt="show" width="240px" /> | <img src="/screenshot/SVID_20220731_203923_1.gif" alt="show" width="240px" /> |

æœ‹å‹åœˆ  | å¿«æ‰‹ | WebView
 ------ | ------  | ------     
 <img src="/screenshot/friends_demo.gif" alt="show" width="240px" />  | <img src="/screenshot/Screenrecording_20230518_165929.gif" alt="show" width="240px" /> |  <img src="/screenshot/Screenrecording_20230518_170044.gif" alt="show" width="240px" /> |


 

## ç‰¹è‰²åŠŸèƒ½

1ï¼Œæ”¯æŒè‡ªå®šä¹‰å›¾ç‰‡åŠ è½½å¼•æ“

2ï¼Œæ”¯æŒå¤šç§å›¾ç‰‡ç¼“å­˜æ¨¡å¼

3ï¼Œæ”¯æŒèŠå¤©ç•Œé¢çš„æŸ¥çœ‹å¤§å›¾åŠŸèƒ½

4ï¼Œæ”¯æŒä»»æ„å®šåˆ¶å±äºä½ çš„å¤§å›¾æŸ¥çœ‹é¡µé¢UIï¼Œå¤šç§å®šåˆ¶æ–¹å¼æ€»æœ‰ä¸€ç§é€‚åˆä½ ï¼ˆ[ç‚¹æ­¤æŸ¥çœ‹æ›´å¤šä½¿ç”¨è¯´æ˜](https://github.com/FlyJingFish/OpenImage/wiki)ï¼‰

5ï¼Œæ”¯æŒæ‰“å¼€åçš„å¤§å›¾é¡µé¢æ•°æ®çš„**å¢ã€åˆ ã€æ”¹ã€æŸ¥**ï¼ˆ[ç‚¹æ­¤æŸ¥çœ‹æ›´å¤šä½¿ç”¨è¯´æ˜](https://github.com/FlyJingFish/OpenImage/wiki#%E6%B3%A8%E6%84%8F-setopenimageactivitycls-%E8%BF%98%E6%94%AF%E6%8C%81%E8%AE%BE%E7%BD%AE%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E6%9B%B4%E5%A4%9A%E8%AF%A6%E7%BB%86%E5%86%85%E5%AE%B9%E8%AF%B7%E7%9C%8B%E8%BF%99%E4%B8%A4%E4%B8%AA-demo-kuaishoudemoactivity%E6%88%96msgrvadapter)ï¼‰

6ï¼Œæ”¯æŒå…¨éƒ¨ **ImageView.ScaleType** æ˜¾ç¤ºæ¨¡å¼çš„å›¾ç‰‡æ‰“å¼€å¤§å›¾æ•ˆæœï¼Œå¹¶ä¸”æ–°å¢**startCropã€endCropã€autoStartCenterCropã€autoEndCenterCrop**å››ç§æ˜¾ç¤ºæ¨¡å¼

7ï¼Œæ”¯æŒå›¾ç‰‡å’Œè§†é¢‘æ··åˆæ•°æ®

8ï¼Œæ”¯æŒä¼ å…¥åŒ…å«å›¾ç‰‡çš„ **RecyclerView**ã€**ViewPager**ã€**ViewPager2**ã€**ListView**ã€**GridView** å’Œ **å¤šä¸ªImageView** çš„è°ƒç”¨æ–¹å¼ï¼Œç”šè‡³ **WebView**ï¼Œå‚»ç“œå¼è°ƒç”¨ï¼Œæ— éœ€å…³å¿ƒå›¾ç‰‡åˆ‡æ¢åè¯¥è¿”å›åˆ°å“ªä¸ªä½ç½®

9ï¼Œæ”¯æŒGifå›¾

10ï¼Œæ”¯æŒé•¿å›¾å’Œé•¿å›¾é˜…è¯»æ¨¡å¼

11ï¼Œæ”¯æŒæ˜¾ç¤ºè¶…å¤§å›¾åŠæ”¾å¤§åçš„æ¸…æ™°ç»†èŠ‚å›¾

12ï¼Œæ”¯æŒè‡ªå®šä¹‰å¤§å›¾åˆ‡æ¢æ•ˆæœï¼ˆPageTransformerï¼‰

## å‰è¨€

1ã€å»ºè®®ä½¿ç”¨Glideæ•ˆæœæ›´å¥½ï¼Œå¦å¤–å»ºè®®å¼€å¯åŸå›¾ç¼“å­˜ï¼ˆæœ‰äº›ç‰ˆæœ¬æ˜¯è‡ªåŠ¨ç¼“å­˜åŸå›¾çš„ï¼‰Glideé€šè¿‡è®¾ç½®diskCacheStrategy ä¸ºDiskCacheStrategy.ALLæˆ–DiskCacheStrategy.DATA

2ã€å½“ç„¶å¦‚æœæ‚¨åŠ è½½çš„æ˜¯æœ¬åœ°å›¾ç‰‡å¯ç›´æ¥å¿½ç•¥ç¬¬1ç‚¹

## ä½¿ç”¨æ­¥éª¤

### ç¬¬ä¸€æ­¥ã€é€‰æ‹©é€‚åˆä½ çš„åº“



#### é¦–å…ˆã€åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„build.gradleæ·»åŠ (1.5.6åŠä¹‹åç‰ˆæœ¬ä»“åº“åœ°å€æ”¹ä¸ºMaven Central)

```gradle
allprojects {
    repositories {
        ...
        maven { url 'https://jitpack.io' }
    }
}
```

**ä½ å¯ä»¥é€‰æ‹©ä¸‹é¢ä¸‰ç§çš„å…¶ä¸­ä¸€ç§ï¼Œåœ¨moduleä¸‹çš„build.gradleæ·»åŠ ã€‚**

<img src="https://github.com/FlyJingFish/OpenImage/blob/master/screenshot/warning_maven_central.svg"/>

#### Aã€ç›´æ¥å¼•å…¥å®Œæ•´ç‰ˆï¼ˆåŒæ—¶æ”¯æŒæŸ¥çœ‹å›¾ç‰‡å’Œè§†é¢‘ï¼‰

è¯·æ³¨æ„å¦‚æœä½¿ç”¨ä»¥ä¸‹å¯¼å…¥æ–¹å¼ï¼Œå¦‚æœä½ çš„é¡¹ç›®ç»„å­˜åœ¨[Glide](https://github.com/bumptech/glide)è¯·å‡çº§è‡³ **4.12.0** æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬ï¼Œå¦‚æœå­˜åœ¨[GSYVideoPlayer](https://github.com/CarGuo/GSYVideoPlayer)è¯·å‡çº§è‡³ **8.3.3** æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬ï¼Œå¦åˆ™ä¼šå†²çª

```
//OpenImageFullLib æ˜¯å®Œæ•´ç‰ˆï¼Œå¦‚æœæ‚¨ä¸æƒ³è‡ªå®šä¹‰å›¾ç‰‡å¼•æ“å’Œè§†é¢‘æ’­æ”¾å™¨å¼•æ“å¯ç›´æ¥å¼•ç”¨ä»¥ä¸‹åº“
implementation 'io.github.FlyJingFish.OpenImage:OpenImageFullLib:1.9.5'
```
#### Bã€å¼•å…¥åªå¸¦æœ‰å›¾ç‰‡å¼•æ“çš„ç‰ˆæœ¬ï¼ˆåªæ”¯æŒæŸ¥çœ‹å›¾ç‰‡ï¼‰

è¯·æ³¨æ„å¦‚æœä½¿ç”¨ä»¥ä¸‹å¯¼å…¥æ–¹å¼ï¼Œå¦‚æœä½ çš„é¡¹ç›®ç»„å­˜åœ¨[Glide](https://github.com/bumptech/glide)è¯·å‡çº§è‡³ **4.12.0** æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬ï¼Œå¦åˆ™ä¼šå†²çª

```
//OpenImageGlideLib å¼•å…¥Glideï¼ˆ4.12.0ï¼‰å›¾ç‰‡å¼•æ“,æ²¡æœ‰å¼•å…¥è§†é¢‘æ’­æ”¾å™¨ï¼›å¦‚éœ€å®šåˆ¶è§†é¢‘æ’­æ”¾åŠŸèƒ½ï¼Œè¯¦ç»†çœ‹Wikiæ–‡æ¡£ï¼Œå¦‚æœä¸æƒ³å®šåˆ¶å¯ç›´æ¥ä½¿ç”¨ä¸Šè¾¹çš„åº“
implementation 'io.github.FlyJingFish.OpenImage:OpenImageGlideLib:1.9.5'
```

#### Cã€å¼•å…¥åŸºç¡€ç‰ˆæœ¬ï¼ˆä¸å¯ä»¥ç›´æ¥æŸ¥çœ‹å›¾ç‰‡å’Œè§†é¢‘ï¼Œå®Œå…¨éœ€è¦è‡ªå®šä¹‰ï¼‰

**è‡ªå·±å®šä¹‰åŠ è½½å¤§å›¾æ—¶è¯·æ³¨æ„å†…å­˜æº¢å‡ºé—®é¢˜ï¼Œè¯¦æƒ…å¯çœ‹Wikiæ–‡æ¡£ï¼ˆ[ç‚¹æ­¤æŸ¥çœ‹å¸¸è§é—®é¢˜](https://github.com/FlyJingFish/OpenImage/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98#12%E4%BD%BF%E7%94%A8openimagelib%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%A7%E5%9B%BE%E5%BC%95%E6%93%8E%E5%87%BA%E7%8E%B0-%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA-%E6%88%96%E8%80%85%E5%A4%A7%E5%9B%BE%E5%8A%A0%E8%BD%BD%E4%B8%8D%E5%87%BA%E6%9D%A5-%E6%88%96%E8%80%85-%E5%87%BA%E7%8E%B0-trying-to-draw-too-large330750000bytes-bitmap-%E6%8A%A5%E9%94%99%E4%BF%A1%E6%81%AF%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E)ï¼‰**

```
//OpenImageLib æ˜¯åŸºç¡€åº“ï¼Œæ²¡æœ‰å¼•å…¥å›¾ç‰‡å¼•æ“å’Œè§†é¢‘æ’­æ”¾å™¨
//è‡³å°‘éœ€è¦å®ç°BigImageHelperæ¥å®šåˆ¶æ‚¨çš„å›¾ç‰‡å¼•æ“ï¼Œå¦‚éœ€å®šåˆ¶è§†é¢‘æ’­æ”¾åŠŸèƒ½ï¼Œè¯¦ç»†çœ‹Wikiæ–‡æ¡£
implementation 'io.github.FlyJingFish.OpenImage:OpenImageLib:1.9.5'

```

### ç¬¬äºŒæ­¥. ç®€å•ä¸€æ­¥è°ƒç”¨å³å¯

å…ˆç¡®ä¿ä½ æœ‰æ²¡æœ‰æ·»åŠ ä»¥ä¸‹æƒé™

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    
</manifest>
```

**ä½ å¯ä»¥é€‰æ‹©ä¸‹é¢ä¸¤ç§å›¾ç‰‡æ•°æ®çš„å…¶ä¸­ä¸€ç§**

#### Aã€ç›´æ¥å°†æ•°æ®è½¬åŒ–ä¸º String çš„List (è¿™ä¸ªæ–¹å¼é€‚åˆåªçœ‹å›¾ç‰‡æˆ–è§†é¢‘ï¼Œä¸å¯æ˜¾ç¤ºæ··åˆæ•°æ®)

```java

List<String> dataList = new ArrayList<>();
for (ImageEntity data : datas) {
    dataList.add(data.getImageUrl());
}

//åœ¨ç‚¹å‡»æ—¶è°ƒç”¨ï¼ˆä»¥ä¸‹ä»¥RecyclerViewä¸ºä¾‹ä»‹ç»ï¼‰
OpenImage.with(activity)
        //ç‚¹å‡»ImageViewæ‰€åœ¨çš„RecyclerViewï¼ˆä¹Ÿæ”¯æŒè®¾ç½®setClickViewPager2ï¼ŒsetClickViewPagerï¼ŒsetClickGridViewï¼ŒsetClickListViewï¼ŒsetClickImageViewï¼ŒsetNoneClickViewï¼‰
        .setClickRecyclerView(recyclerView,new SourceImageViewIdGet() {
           @Override
           public int getImageViewId(OpenImageUrl data, int position) {
               return R.id.iv_image;//ç‚¹å‡»çš„ImageViewçš„Idæˆ–è€…åˆ‡æ¢å›¾ç‰‡åå¯¹åº”çš„ImageViewçš„Id
           }
       })
       //ç‚¹å‡»çš„ImageViewçš„ScaleTypeç±»å‹ï¼ˆå¦‚æœè®¾ç½®ä¸å¯¹ï¼Œæ‰“å¼€çš„åŠ¨ç”»æ•ˆæœå°†æ˜¯é”™è¯¯çš„ï¼‰
       .setSrcImageViewScaleType(ImageView.ScaleType.CENTER_CROP,true)
       //RecyclerViewçš„æ•°æ®
       .setImageUrlList(dataList, MediaType.IMAGE)
       //ç‚¹å‡»çš„ImageViewæ‰€åœ¨æ•°æ®çš„ä½ç½®
       .setClickPosition(position)
       //å¼€å§‹å±•ç¤ºå¤§å›¾
       .show();
```

**åœ¨æ­¤ç€é‡å†ä»‹ç»ä¸‹ SourceImageViewIdGet åœ¨è¿™æ˜¯åŠ¨æ€è·å– ImageView çš„Idçš„ï¼Œå¦‚æœä½ çš„ RecyclerViewï¼ˆæˆ–ViewPager2ã€ListViewã€GridViewï¼‰
å±•ç¤ºçš„å›¾ç‰‡ Id å‡ºç°å¤šä¸ªåˆ™éœ€æ ¹æ® getImageViewId ä¸­çš„ position æˆ– data æ¥è¿”å›å¯¹åº”çš„ Idï¼Œä¾‹å¦‚ï¼š**

```java
new SourceImageViewIdGet() {
   @Override
   public int getImageViewId(OpenImageUrl data, int position) {
        //data å¯å¼ºè½¬ä¸ºæ‚¨ä¼ å…¥çš„æ•°æ®ç±»å‹
        MessageBean msgBean = (MessageBean) data;
        //åœ¨æ­¤è§†é¢‘æ•°æ®å’Œå›¾ç‰‡æ•°æ®çš„ ImageView çš„ Id ä¸ä¸€æ ·ï¼ˆæ ¹æ®æ‚¨å…·ä½“æƒ…å†µè¿”å›å¯¹åº”çš„Idå³å¯ï¼Œä»¥ä¸‹ä»…ä¸ºç¤ºä¾‹ï½ï¼‰
        if (msgBean.type == MessageBean.IMAGE){
            return R.id.iv_image;
        }else {
            return R.id.iv_video;
        }
   }
}

```


#### Bã€åœ¨æ‚¨çš„æ•°æ®å®ä½“ç±»ä¸Šå®ç°OpenImageUrlæ¥å£(è¿™ä¸ªæ–¹å¼é€‚åˆæ˜¾ç¤ºå›¾ç‰‡å’Œè§†é¢‘çš„æ··åˆæ•°æ®ï¼Œå»ºè®®ä½¿ç”¨è¿™ä¸ªæ–¹å¼)

**PS:åˆ—è¡¨ä¸­å±•ç¤ºçš„å›¾ç‰‡é“¾æ¥å’Œå±•ç¤ºå¤§å›¾æ—¶æ‰€ç”¨é“¾æ¥æ˜¯ä¸åŒæ—¶ï¼ˆå³å­˜åœ¨ç¼©ç•¥å›¾å’ŒåŸå§‹å¤§å›¾ä¸¤ç§é“¾æ¥çš„æƒ…å†µï¼‰ï¼Œè¿™ç§æ–¹å¼å¯ä»¥æœ‰æ›´å¥½çš„è¿‡æ¸¡æ•ˆæœ**

```java
public class ImageEntity implements OpenImageUrl {
    public String photoUrl;//å›¾ç‰‡å¤§å›¾
    public String smallPhotoUrl;//å›¾ç‰‡å°å›¾
    public String coverUrl;//è§†é¢‘å°é¢å¤§å›¾
    public String smallCoverUrl;//è§†é¢‘å°é¢å°å›¾
    public String videoUrl;//è§†é¢‘é“¾æ¥
    public int resouceType; //0å›¾ç‰‡1è§†é¢‘ 

    @Override
    public String getImageUrl() {
        return resouceType == 1 ? coverUrl : photoUrl;//å¤§å›¾é“¾æ¥ï¼ˆæˆ–è§†é¢‘çš„å°é¢å¤§å›¾é“¾æ¥ï¼‰
    }

    @Override
    public String getVideoUrl() {
        return videoUrl;//è§†é¢‘é“¾æ¥
    }

    @Override
    public String getCoverImageUrl() {//è¿™ä¸ªä»£è¡¨å‰è¾¹åˆ—è¡¨å±•ç¤ºçš„å›¾ç‰‡ï¼ˆå³ç¼©ç•¥å›¾ï¼‰
        return resouceType == 1 ? smallCoverUrl : smallPhotoUrl;//å°é¢å°å›¾é“¾æ¥ï¼ˆæˆ–è§†é¢‘çš„å°é¢å°å›¾é“¾æ¥ï¼‰
    }

    @Override
    public MediaType getType() {
        return resouceType == 1 ? MediaType.VIDEO : MediaType.IMAGE;//æ•°æ®æ˜¯å›¾ç‰‡è¿˜æ˜¯è§†é¢‘
    }
}

```

**ç„¶åè°ƒç”¨æ˜¾ç¤º**

```java

//åœ¨ç‚¹å‡»æ—¶è°ƒç”¨ï¼ˆä»¥ä¸‹ä»¥RecyclerViewä¸ºä¾‹ä»‹ç»ï¼‰
OpenImage.with(activity)
        //ç‚¹å‡»ImageViewæ‰€åœ¨çš„RecyclerViewï¼ˆä¹Ÿæ”¯æŒè®¾ç½®setClickViewPager2ï¼ŒsetClickViewPagerï¼ŒsetClickGridViewï¼ŒsetClickListViewï¼ŒsetClickImageViewï¼ŒsetNoneClickViewï¼‰
        .setClickRecyclerView(recyclerView,new SourceImageViewIdGet() {
           @Override
           public int getImageViewId(OpenImageUrl data, int position) {
               return R.id.iv_image;//ç‚¹å‡»çš„ImageViewçš„Idæˆ–è€…åˆ‡æ¢å›¾ç‰‡åå¯¹åº”çš„ImageViewçš„Id
           }
       })
       //ç‚¹å‡»çš„ImageViewçš„ScaleTypeç±»å‹ï¼ˆå¦‚æœè®¾ç½®ä¸å¯¹ï¼Œæ‰“å¼€çš„åŠ¨ç”»æ•ˆæœå°†æ˜¯é”™è¯¯çš„ï¼‰
       .setSrcImageViewScaleType(ImageView.ScaleType.CENTER_CROP,true)
       //RecyclerViewçš„æ•°æ®
       .setImageUrlList(datas)
       //ç‚¹å‡»çš„ImageViewæ‰€åœ¨æ•°æ®çš„ä½ç½®
       .setClickPosition(position)
       //å¼€å§‹å±•ç¤ºå¤§å›¾
       .show();
```

**å¦‚æœæ²¡æœ‰å¯ä»¥ä¼ çš„Viewï¼ˆå³ä¸ä½¿ç”¨åŠ¨ç”»æ‰“å¼€å¤§å›¾é¡µé¢ï¼‰**

```java

//åœ¨ç‚¹å‡»æ—¶è°ƒç”¨ï¼ˆä»¥ä¸‹ä»¥RecyclerViewä¸ºä¾‹ä»‹ç»ï¼‰
OpenImage.with(activity)
        //æ‰“å¼€å¤§å›¾é¡µé¢æ—¶æ²¡æœ‰ç‚¹å‡»çš„ImageViewåˆ™ç”¨è¿™ä¸ª
        .setNoneClickView()
        //å›¾ç‰‡çš„æ•°æ®
        .setImageUrlList(datas)
        //é»˜è®¤å±•ç¤ºæ•°æ®çš„ä½ç½®
        .setClickPosition(position)
        //å¼€å§‹å±•ç¤ºå¤§å›¾
        .show();
```

**PS.å®Œæ•´è°ƒç”¨ç¤ºä¾‹**

```java

//åœ¨ç‚¹å‡»æ—¶è°ƒç”¨ï¼ŒæŒ‰éœ€ä½¿ç”¨å³å¯ï¼ˆä»¥ä¸‹ä»¥RecyclerViewä¸ºä¾‹ä»‹ç»ï¼‰
OpenImage.with(activity)
         //ç‚¹å‡»ImageViewæ‰€åœ¨çš„RecyclerViewï¼ˆä¹Ÿæ”¯æŒè®¾ç½®setClickViewPager2ï¼ŒsetClickViewPagerï¼ŒsetClickGridViewï¼ŒsetClickListViewï¼ŒsetClickImageViewï¼‰
         .setClickRecyclerView(recyclerView,new SourceImageViewIdGet() {
           @Override
           public int getImageViewId(OpenImageUrl data, int position) {
               return R.id.iv_image;//ç‚¹å‡»çš„ImageViewçš„Idæˆ–è€…åˆ‡æ¢å›¾ç‰‡åå¯¹åº”çš„ImageViewçš„Id
           }
        })
        //ç‚¹å‡»çš„ImageViewçš„ScaleTypeç±»å‹ï¼ˆå¦‚æœè®¾ç½®ä¸å¯¹ï¼Œæ‰“å¼€çš„åŠ¨ç”»æ•ˆæœå°†æ˜¯é”™è¯¯çš„ï¼‰
        .setSrcImageViewScaleType(ImageView.ScaleType.CENTER_CROP,true)
        //RecyclerViewçš„æ•°æ®
        .setImageUrlList(datas)
        //ç‚¹å‡»çš„ImageViewæ‰€åœ¨æ•°æ®çš„ä½ç½®
        .setClickPosition(position)
        //clickDataPosition ç‚¹å‡»çš„æ•°æ®æ‰€åœ¨ä½ç½® clickViewPosition ç‚¹å‡»çš„è§†å›¾æ‰€åœ¨ä½ç½®ï¼ˆå’Œä¸Šè¾¹æ–¹æ³•äºŒé€‰ä¸€ï¼Œè¯¦ç»†ä½¿ç”¨æ–¹æ³•å¯çœ‹wikiæ–‡æ¡£ï¼‰
        //è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯é’ˆå¯¹çš„æ˜¯åƒèŠå¤©é¡µé¢é‚£ç§å›¾æ–‡æ··åˆçš„æ•°æ®ï¼Œå¯ä»¥çœ‹ "èŠå¤©é¡µé¢" Demo
        .setClickPosition(clickDataPosition, clickViewPosition)
        //å¯ä¸è®¾ç½®ï¼ˆå®šåˆ¶é¡µé¢æ ·å¼ï¼Œè¯¦ç»†å¯çœ‹Wikiæ–‡æ¡£ï¼‰
        .setOpenImageStyle(R.style.DefaultPhotosTheme)
        //è®¾ç½®æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šå±‚çš„fragmentï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setUpperLayerFragmentCreate(new FriendLayerFragmentCreateImpl(),bundle,false,false)
        //è®¾ç½®è‡ªå®šä¹‰çš„è§†é¢‘æ’­æ”¾fragmenté¡µé¢ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setVideoFragmentCreate(new VideoFragmentCreateImpl())
        //è®¾ç½®åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºçš„å›¾ç‰‡ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setErrorResId(R.mipmap.ic_launcher)
        //è®¾ç½®é€€å‡ºé¡µé¢æ—¶ï¼Œå¦‚æœé¡µé¢æ— å¯¹åº”çš„ImageViewåˆ™å›åˆ°ç‚¹å‡»ä½ç½®ï¼ˆç±»ä¼¼å¾®ä¿¡èŠå¤©é¡µé¢çš„æ•ˆæœï¼‰ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setWechatExitFillInEffect(true)
        //è®¾ç½®trueåå…³é—­æ—¶ï¼Œå°†çœ‹ä¸åˆ°å‰ä¸€é¡µé¢æ­£åœ¨æŸ¥çœ‹çš„å›¾ç‰‡ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setShowSrcImageView(true)
        //è®¾ç½®è‡ªå®šä¹‰çš„å¤§å›¾å¤–å£³é¡µé¢ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setOpenImageActivityCls(MyBigImageActivity.class)
        //è®¾ç½®åˆ‡æ¢å›¾ç‰‡æ—¶å‰ä¸€é¡µé¢è·Ÿéšæ»šåŠ¨ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setAutoScrollScanPosition(true)
        //è®¾ç½®æ˜¾ç¤ºä¸‹è½½æŒ‰é’®ï¼ˆå¯ä¸è®¾ç½®ï¼Œé»˜è®¤ä¸æ˜¾ç¤ºï¼‰
        .setShowDownload()
        //è®¾ç½®ç”»å»Šæ•ˆæœï¼Œå‚æ•°ä¸ºå·¦å³ä¸¤ä¾§æ¼å‡ºçš„å®½åº¦ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setGalleryEffect(10)
        //è®¾ç½®åˆ‡æ¢å›¾ç‰‡ç›‘å¬ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setOnSelectMediaListener(new OnSelectMediaListener() {
            @Override
            public void onSelect(OpenImageUrl openImageUrl, int position) {

            }
        })
        //è®¾ç½®ç‚¹å‡»ç›‘å¬ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setOnItemClickListener(new OnItemClickListener() {
            @Override
            public void onItemClick(BaseInnerFragment fragment, OpenImageUrl openImageUrl, int position) {
    
            }
        })
        //è®¾ç½®é•¿æŒ‰å›¾ç‰‡ç›‘å¬ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setOnItemLongClickListener(new OnItemLongClickListener() {
            @Override
            public void onItemLongClick(BaseInnerFragment fragment, OpenImageUrl openImageUrl, int position) {
            
            }
        })
        //è®¾ç½®é€€å‡ºå¤§å›¾é¡µé¢æ—¶çš„ç›‘å¬ï¼ˆå¯ä¸è®¾ç½®ï¼‰
        .setOnExitListener(new OnExitListener() {
            @Override
            public void onExit() {
            
            }
        })
        //è®¾ç½®åˆ‡æ¢å¤§å›¾æ—¶çš„æ•ˆæœï¼ˆå¯ä¸è®¾ç½®ï¼Œæœ¬åº“ä¸­ç›®å‰åªæœ‰è¿™ä¸€ä¸ªï¼Œå¦‚éœ€å…¶ä»–æ•ˆæœå¯å‚ç…§ScaleInTransformerè‡ªè¡Œå®šä¹‰æ•ˆæœï¼‰
        .addPageTransformer(new ScaleInTransformer())
        //å¼€å§‹å±•ç¤ºå¤§å›¾
        .show();
```
### é¢å¤–æ­¥éª¤

#### Aã€å¦‚æœæ‚¨å¼•ç”¨çš„åº“æ˜¯ OpenImageLib æ‚¨éœ€è¦å®ç°BigImageHelperæ¥å£å¹¶è®¾ç½®å®ƒï¼Œå®ƒæ˜¯åŠ è½½å¤§å›¾çš„å…³é”®ï¼ˆä»¥ä¸‹ä»¥Glideä¸ºä¾‹ï¼‰
**ï¼ˆå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ OpenImageFullLib æˆ– OpenImageGlideLib åˆ™ä¸éœ€è¦è¿™ä¸€æ­¥ï¼‰**

```java
 public class MyApplication extends Application {
     @Override
     public void onCreate() {
         super.onCreate();
         //åˆå§‹åŒ–å¤§å›¾åŠ è½½å™¨
         OpenImageConfig.getInstance().setBigImageHelper(new BigImageHelperImpl());
     }
 }
 
 public class BigImageHelperImpl implements BigImageHelper {
    @Override
    public void loadImage(Context context, String imageUrl, OnLoadBigImageListener onLoadBigImageListener) {
        //è¿™ä¸ªåœ°æ–¹åªæ˜¯ç¤ºä¾‹ï¼Œå¦‚æœä½ çš„é¡¹ç›®å­˜åœ¨è¶…å¤§å›¾ï¼Œè¯·æ³¨æ„éœ€è¦è‡ªè¡Œå¤„ç†ï¼ˆå¦åˆ™å¯èƒ½å†…å­˜æº¢å‡ºæˆ–å´©æºƒï¼‰
        //ä¸æƒ³è‡ªå·±æçš„ï¼Œå¯ç›´æ¥ç”¨ OpenImageGlideLib æˆ– OpenImageFullLib
        RequestOptions requestOptions = new RequestOptions()
                    .diskCacheStrategy(DiskCacheStrategy.ALL)
                    //è¿™å¥æ˜¯ä¸ºäº†åŠ è½½åŸå›¾ï¼Œå¦‚æœä½ çš„åŸå›¾å¯èƒ½æ˜¯è¶…å¤§å›¾ï¼Œè¯·æ³¨æ„å†…å­˜æº¢å‡ºé—®é¢˜ï¼Œä¸æƒ³è‡ªå·±æçš„ï¼Œå¯ç›´æ¥ç”¨ OpenImageGlideLib æˆ– OpenImageFullLib
                    .override(Target.SIZE_ORIGINAL, Target.SIZE_ORIGINAL)
                    .format(DecodeFormat.PREFER_RGB_565);
        Glide.with(context)
                    .load(imageUrl).apply(requestOptions).addListener(new RequestListener<Drawable>() {
                @Override
                public boolean onLoadFailed(@Nullable GlideException e, Object model, Target<Drawable> target, boolean isFirstResource) {
                    onLoadBigImageListener.onLoadImageFailed();
                    return false;
                }

                @Override
                public boolean onResourceReady(Drawable resource, Object model, Target<Drawable> target, DataSource dataSource, boolean isFirstResource) {
                    onLoadBigImageListener.onLoadImageSuccess(resource);
                    return false;
                }
            }).into(new CustomTarget<Drawable>() {
                @Override
                public void onResourceReady(@NonNull Drawable resource, @Nullable Transition<? super Drawable> transition) {

                }

                @Override
                public void onLoadCleared(@Nullable Drawable placeholder) {

                }
            });

    }

}
```

#### Bã€å¦‚æœæ‚¨å¼•ç”¨çš„åº“æ˜¯ OpenImageLib æˆ– OpenImageGlideLib éœ€è¦æŸ¥çœ‹è§†é¢‘çš„åŠŸèƒ½ï¼Œéœ€è¦ä»¥ä¸‹æ­¥éª¤
**ï¼ˆå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ OpenImageFullLib åˆ™ä¸éœ€è¦è¿™ä¸€æ­¥ï¼‰**

```java

public class MyApplication extends Application {
    @Override
    public void onCreate() {
        super.onCreate();
        //åˆå§‹åŒ–è§†é¢‘åˆ›å»ºç±»
        OpenImageConfig.getInstance().setVideoFragmentCreate(new VideoFragmentCreateImpl());
    }
}
public class VideoFragmentCreateImpl implements VideoFragmentCreate {
   @Override
   public BaseFragment createVideoFragment() {
       return new VideoPlayerFragment();
   }
}

public class VideoPlayerFragment extends BaseImageFragment<ENDownloadView> {

   private FragmentVideoBinding binding;
   private String playerKey;
   private boolean isLoadImageFinish;
   protected boolean isPlayed;

   @Override
   protected ImageView getSmallCoverImageView() {//è¿”å›å°å°é¢å›¾
       return binding.videoPlayer.getSmallCoverImageView();
   }

   @Override
   protected ImageView getPhotoView() {//è¿”å›å¤§å°é¢å›¾ï¼Œå¿…é¡»åœ¨å°å°é¢å›¾ä¸‹è¾¹
       return binding.videoPlayer.getCoverImageView();
   }

   @Override
   protected ENDownloadView getLoadingView() {//è¿”å›loadingView
       return (ENDownloadView) binding.videoPlayer.getLoadingView();
   }

   @Override
   protected void hideLoading(ENDownloadView pbLoading) {//éšè—loadingéœ€è¦ç‰¹æ®Šå¤„ç†çš„é‡å†™è¿™ä¸ª
       super.hideLoading(pbLoading);
       pbLoading.release();
       binding.videoPlayer.getStartButton().setVisibility(View.VISIBLE);
   }

   @Override
   protected void showLoading(ENDownloadView pbLoading) {//æ˜¾ç¤ºloadingéœ€è¦ç‰¹æ®Šå¤„ç†çš„é‡å†™è¿™ä¸ª
       super.showLoading(pbLoading);
       pbLoading.start();
       binding.videoPlayer.getStartButton().setVisibility(View.GONE);
   }

   @Override
   public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
       super.onViewCreated(view, savedInstanceState);
       binding.videoPlayer.findViewById(R.id.back).setOnClickListener(v -> close());
       playerKey = binding.videoPlayer.getVideoKey();
       binding.videoPlayer.goneAllWidget();
       isPlayed = false;
   }
   @Override
   protected void onTouchClose(float scale) {//ä¸‹æ‹‰å…³é—­å›è°ƒ
       super.onTouchClose(scale);
       binding.videoPlayer.findViewById(R.id.surface_container).setVisibility(View.GONE);
       binding.videoPlayer.goneAllWidget();
   }

   @Override
   protected void onTouchScale(float scale) {//ä¸‹æ‹‰æ—¶å›è°ƒ
       super.onTouchScale(scale);
       binding.videoPlayer.goneAllWidget();
       if (scale == 1){
           binding.videoPlayer.showAllWidget();
       }
   }

   @Override
   protected void loadImageFinish(boolean isLoadImageSuccess) {
       isLoadImageFinish = true;
       play();
   }

   private void play(){
       if (isTransitionEnd && isLoadImageFinish && !isPlayed){//è¿™é‡Œå¯ä»¥ä¸ç­‰å°é¢å›¾åŠ è½½å®Œå°±æ’­æ”¾ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†æ›´å¥½çš„æ•ˆæœ
           if (getLifecycle().getCurrentState() == Lifecycle.State.RESUMED){
               toPlay4Resume();
           }else {
               getLifecycle().addObserver(new LifecycleEventObserver() {
                   @Override
                   public void onStateChanged(@NonNull LifecycleOwner source, @NonNull Lifecycle.Event event) {
                       if (event == Lifecycle.Event.ON_RESUME){
                           toPlay4Resume();
                           source.getLifecycle().removeObserver(this);
                       }
                   }
               });
           }

           isPlayed = true;
       }
   }

   protected void toPlay4Resume(){
       binding.videoPlayer.playUrl(openImageBean.getVideoUrl());
       binding.videoPlayer.startPlayLogic();
   }

   @Override
   protected void onTransitionEnd() {
       super.onTransitionEnd();
       play();
   }

   @Override
   public void onResume() {
       super.onResume();
       if (playerKey != null) {
           GSYVideoController.resumeByKey(playerKey);
       }
   }

   @Override
   public void onPause() {
       super.onPause();
       if (playerKey != null) {
           GSYVideoController.pauseByKey(playerKey);
       }
   }

   @Override
   public void onDestroyView() {
       super.onDestroyView();
       if (playerKey != null) {
           GSYVideoController.cancelByKeyAndDeleteKey(playerKey);
       }
   }

   @Override
   public View getExitImageView() {//é€€å‡ºé¡µé¢æ—¶éœ€è¦ä¿è¯å°é¢å›¾å¯è§
       binding.videoPlayer.getThumbImageViewLayout().setVisibility(View.VISIBLE);
       return super.getExitImageView();
   }
}

```

# ç‚¹å‡»ä»¥ä¸‹é“¾æ¥æŸ¥çœ‹æ›´å¤šä½¿ç”¨è¯´æ˜

[ç‚¹æ­¤æŸ¥çœ‹æ›´å¤šä½¿ç”¨è¯´æ˜](https://github.com/FlyJingFish/OpenImage/wiki)

## æ›´æ–°æ—¥å¿—

[ç‚¹æ­¤æŸ¥çœ‹æ›´æ–°æ—¥å¿—](https://github.com/FlyJingFish/OpenImage/blob/master/update_record.md)

# æ··æ·†

### ä¸€ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ OpenImageFullLib éœ€è¦éµå¾ªä»¥ä¸‹ä¸‰æ–¹åº“çš„è§„åˆ™

[GSYVideoPlayer](https://github.com/FlyJingFish/GSYVideoPlayer)

[Glide](https://github.com/bumptech/glide)

### äºŒï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ OpenImageGlideLib éœ€è¦éµå¾ªä»¥ä¸‹ä¸‰æ–¹åº“çš„è§„åˆ™
[Glide](https://github.com/bumptech/glide)

### ä¸‰ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ OpenImageLib åˆ™ä¸éœ€è¦æ·»åŠ ä»»ä½•æ··æ·†è§„åˆ™

### ä¸ºäº†æ–¹ä¾¿æˆ‘å°†æ‰€æœ‰çš„æ··æ·†è§„åˆ™ç›´æ¥ç²˜è´´å¦‚ä¸‹ï¼š

GSYVideoPlayer çš„æ··æ·†è§„åˆ™ï¼š

```
-keep class com.shuyu.gsyvideoplayer.video.** { *; }
-dontwarn com.shuyu.gsyvideoplayer.video.**
-keep class com.shuyu.gsyvideoplayer.video.base.** { *; }
-dontwarn com.shuyu.gsyvideoplayer.video.base.**
-keep class com.shuyu.gsyvideoplayer.utils.** { *; }
-dontwarn com.shuyu.gsyvideoplayer.utils.**
-keep class tv.danmaku.ijk.** { *; }
-dontwarn tv.danmaku.ijk.**

-keep public class * extends android.view.View{
    *** get*();
    void set*(***);
    public <init>(android.content.Context);
    public <init>(android.content.Context, java.lang.Boolean);
    public <init>(android.content.Context, android.util.AttributeSet);
    public <init>(android.content.Context, android.util.AttributeSet, int);
}
```

Glide çš„æ··æ·†è§„åˆ™ï¼š

```
-keep public class * implements com.bumptech.glide.module.GlideModule
-keep class * extends com.bumptech.glide.module.AppGlideModule {
 <init>(...);
}
-keep public enum com.bumptech.glide.load.ImageHeaderParser$** {
  **[] $VALUES;
  public *;
}
-keep class com.bumptech.glide.load.data.ParcelFileDescriptorRewinder$InternalRewinder {
  *** rewind();
}

```

## ç‰ˆæœ¬é™åˆ¶
æœ€ä½SDKç‰ˆæœ¬ï¼šminSdkVersion >= 21
 
## [ç‚¹æ­¤ä¸‹è½½apk](https://github.com/FlyJingFish/OpenImage/blob/master/apk/release/app-release.apk?raw=true)
 
### å¸¸è§é—®é¢˜

##### [ç‚¹æ­¤æŸ¥çœ‹å¸¸è§é—®é¢˜](https://github.com/FlyJingFish/OpenImage/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98)

### Thanks

- [PhotoView](https://github.com/Baseflow/PhotoView)

### èµèµ

éƒ½çœ‹åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœæ‚¨å–œæ¬¢ OpenImageï¼Œæˆ–æ„Ÿè§‰ OpenImage å¸®åŠ©åˆ°äº†æ‚¨ï¼Œå¯ä»¥ç‚¹å³ä¸Šè§’â€œStarâ€æ”¯æŒä¸€ä¸‹ï¼Œæ‚¨çš„æ”¯æŒå°±æ˜¯æˆ‘çš„åŠ¨åŠ›ï¼Œè°¢è°¢ï½ ğŸ˜ƒ

å¦‚æœæ„Ÿè§‰ OpenImage ä¸ºæ‚¨èŠ‚çº¦äº†å¤§é‡å¼€å‘æ—¶é—´ã€ä¸ºæ‚¨çš„é¡¹ç›®å¢å…‰æ·»å½©ï¼Œæ‚¨ä¹Ÿå¯ä»¥æ‰«æä¸‹é¢çš„äºŒç»´ç ï¼Œè¯·ä½œè€…å–æ¯å’–å•¡ â˜•

<div>
<img src="/screenshot/IMG_4075.PNG" width="280" height="350">
<img src="/screenshot/IMG_4076.JPG" width="280" height="350">
</div>

### è”ç³»æ–¹å¼

* æœ‰é—®é¢˜å¯ä»¥åŠ ç¾¤å¤§å®¶ä¸€èµ·äº¤æµ [QQï¼š221045694](https://qm.qq.com/cgi-bin/qm/qr?k=7DPRtMv2TjheueV5nyXYGdi_LAJJ8rgW&jump_from=webapi&authKey=suIbGOhGIaDh7JRskUotAZnKBBZp8ptNB58x5jTmS7+2FiOwSH1TATdKMrdtbONz)

<img src="/screenshot/qq.jpg" width="220"/>

